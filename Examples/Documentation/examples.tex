\chapter{Example Handling, Creating new Examples}
\label{chap:howtoex}
\section{Getting started}
Beside the fact that \dope{} is still under development,
it offers already various different (linear and nonlinear) 
examples for a lots 
of different applications in two and three dimensions; 
we refer the reader to the 
next two Chapters \ref{PDE} and \ref{OPT}. 

To implement new examples or to use existing examples 
from the library for own research, the user 
can simply copy an existing example. In this 
new example, own code and changes can be compiled. Here is some 
advice to get started:
\begin{itemize}
\item If you are a first time user of \dope{} 
with some numerics background, you 
might be familiar with the Poisson (or more general Laplace) equation.
\dope{} has it too. Check-out Example \ref{PDE_Stat_Laplace_2D},
to see how \dope{} implements this well-known equation in two
dimensions or \ref{PDE_Stat_Laplace_3D} for its three-dimensional version.
\item Before you implement a new example, please check which 
existing example might be similar to your goals and get familiar 
to it. Then, proceed as described in Section \ref{getting_started}. 
\end{itemize}
%\begin{remark}[Why two examples for the Laplace equation?]
%\dope{} offers dimensional-independent programming! So, we could have 
%implemented the 2d and 3d case in one file. The reason why we
%present
%to separate programs \ref{PDE_Stat_Laplace_2D} and \ref{PDE_Stat_Laplace_3D}
%is, that in the 3d case, we show additional 
%capabilities of the library itself; specifically how to use different
%iterative linear solvers.
%\end{remark}


\section{Creating new examples}
\label{getting_started}
Before being able to change and compile the new code, the user must 
follow some easy steps in order to modify the information related to the old code. In 
this section we explain how to modify such information using as model 
\texttt{PDE/StatPDE/Example1}.

\begin{enumerate}
 \item In a first step, we copy \texttt{Example1} and renamed it, e.g., 
\texttt{MyWonderfulFirstExample}. At the same time it is important to remove the repository 
information that it is stored in the directory \texttt{.svn/}. \\
After having reached the folder of the example in question in the terminal, 
\texttt{PDE/StatPDE} in our case, we perform these operation writing the following:
\begin{verbatim}
cp -r Example1 MyWonderfulFirstExample
cd MyWonderfulFirstExample
rm -rf .svn
cd Test
rm -rf .svn
\end{verbatim}
Please note that removing the \texttt{.svn} sub-directories is important,
as otherwise your files may be replaced or changed during your next
update. Also, if you can submit information to the subversion repository 
you might accidentally overwrite the original example, here \texttt{Example1}.

\item We now have to change the target in the \texttt{Makefile}, 
  otherwise our new example will refer to the executable of the old one.
  
  Thus we open the \texttt{Makefile} in the directory \texttt{MyWonderfulFirstExample}
  to change the name of the executable. In our example you will find a line
\begin{verbatim}
target   = $(BINDIR)/DOpE-PDE-StatPDE-Example1-$
           (dope_dimension)d-$(deal_II_dimension)d
\end{verbatim}
Here we need to replace the target to a new name to avoid any 
possible complication. Thus for example we change the line to 
\begin{verbatim}
target   = $(BINDIR)/MyWonderfulFirstExample
\end{verbatim}
This will build the executable file in the standard binary directory 
of \texttt{DOpElib}, i.e., \texttt{\$(DOpE)/bin}, under the name 
\texttt{MyWonderfulFirstExample}.

\textit{Note that you should use a different name for all your 
examples as otherwise you may experience a lot of strange behavior, as
the executable will be overwritten by all your examples!}

\item If you want to run automated tests on you program so that you can 
  verify whether your code is running as expected after updating the 
  library you may want to update the sub-directory \texttt{Test} 
  as well, see also Chapter~\ref{chap:test}. Otherwise you may skip this 
  step.

  Change to the \texttt{Test} sub-directory. And then modify the
  test-script to contain the new name of the executable.
  Assuming you want to use Emacs, open the file \texttt{test.sh}
\begin{verbatim}
PDE/StatPDE/Example1/Test> emacs test.sh
\end{verbatim}
where, in our example you find two times the lines
\begin{verbatim}
echo "Running Program ../../../../../bin/DOpE-PDE-StatPDE-Example1-2d-2d test.prm"
(../../../../../bin/DOpE-PDE-StatPDE-Example1-2d-2d test.prm 2>&1) > /dev/null
\end{verbatim} 
if you made a copy of an other example the part \texttt{DOpE-PDE-StatPDE-Example1-2d-2d}
may differ. These lines need to be replaced with the new name of the 
executable, i.e., for our given example
\begin{verbatim}
echo "Running Program ../../../../../bin/MyWonderfulFirstExample test.prm"
(../../../../../bin/MyWonderfulFirstExample test.prm 2>&1) > /dev/null
\end{verbatim} 

\item  Now, you are prepared to change any of the problem
  dependent data in information in the files 
\begin{verbatim}
main.cc, localpde.h, functionals.h, localfunctional.h, etc
\end{verbatim} 

\item Once you have finished and are sure that your example is running correctly
  and you want to use the automated test scripts --see 3) above-- You need 
  to store new test information to account for your changes. 
  
  To do so, change to the \texttt{Test} sub-directory and run the test:
\begin{verbatim}
./test Test
\end{verbatim}
  Note that this should fail, otherwise you have not changed anything in the program, 
  or forgot part 3) of this description.
  
  If it failed have a look into the file \texttt{dope.log} and see whether you like the 
  output. If you do not like it you may wish to update the file \texttt{test.prm} that 
  takes care of the parameters for the test run.
  
  Once your satisfied with what you see in the log-file \texttt{dope.log} you need to store 
  that information using
\begin{verbatim}
./test Store
\end{verbatim}
\end{enumerate}


